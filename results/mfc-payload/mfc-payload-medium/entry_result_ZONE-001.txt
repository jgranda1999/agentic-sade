======================================================================
FINAL DECISION
======================================================================
Type: APPROVED-CONSTRAINTS
SADE Message: APPROVED-CONSTRAINTS,(SPEED_LIMIT(7m/s),MAX_ALTITUDE(30m))
Constraints: ['SPEED_LIMIT(7m/s)', 'MAX_ALTITUDE(30m)']
Explanation: Approved with constraints: wind and gusts are near the demonstrated/gust capability envelope; high-severity incident resolution for prefix 0011 verified by Claims Agent; constraints applied for safety margin. Environment Agent: wind within MFC but gusts elevated. Reputation Agent: historical risk high, pattern of prior incidents, claims satisfied for high-severity incident mitigation.
======================================================================

Full output (decision + visibility):
{
  "decision": {
    "type": "APPROVED-CONSTRAINTS",
    "sade_message": "APPROVED-CONSTRAINTS,(SPEED_LIMIT(7m/s),MAX_ALTITUDE(30m))",
    "constraints": [
      "SPEED_LIMIT(7m/s)",
      "MAX_ALTITUDE(30m)"
    ],
    "action_id": null,
    "actions": [],
    "denial_code": null,
    "explanation": "Approved with constraints: wind and gusts are near the demonstrated/gust capability envelope; high-severity incident resolution for prefix 0011 verified by Claims Agent; constraints applied for safety margin. Environment Agent: wind within MFC but gusts elevated. Reputation Agent: historical risk high, pattern of prior incidents, claims satisfied for high-severity incident mitigation."
  },
  "visibility": {
    "entry_request": {
      "sade_zone_id": "ZONE-001",
      "pilot_id": "PILOT-12345",
      "organization_id": "ORG-ABC",
      "drone_id": "DRONE-XYZ-001",
      "payload": "10.0",
      "requested_entry_time": "2026-02-02T10:00:00Z",
      "request_type": "ZONE"
    },
    "environment_agent": {
      "manufacturer_fc": {
        "manufacturer": "Freefly Systems",
        "model": "ALTA X",
        "category": "heavy-lift",
        "mfc_payload_max_kg": 15.9,
        "mfc_max_wind_kt": 19.4
      },
      "raw_conditions": {
        "wind": 14.2,
        "wind_gust": 17.0,
        "precipitation": "none",
        "visibility": 3.0,
        "light_conditions": "daylight",
        "spatial_constraints": {
          "airspace_class": "Class E",
          "no_fly_zones": [],
          "restricted_areas": []
        }
      },
      "risk_assessment": {
        "risk_level": "MEDIUM",
        "blocking_factors": [],
        "marginal_factors": [
          "elevated_wind_gusts",
          "elevated_payload_weight"
        ]
      },
      "constraint_suggestions_wind": [
        "SPEED_LIMIT(17kt)"
      ],
      "constraint_suggestions_payload": [],
      "recommendation_wind": "MEDIUM",
      "recommendation_payload": "MEDIUM",
      "recommendation_prose_wind": "Wind gusts are elevated but remain below the MFC maximum wind limit. Risk is medium due to increased gusts.",
      "recommendation_prose_payload": "Payload is above 5 kg and may require caution but is below the MFC payload limit. Risk is medium.",
      "why_prose_wind": "Measured gusts at 17.0 kt are above the threshold for medium risk (5 kt) and well below the MFC maximum (19.4 kt), making wind risk medium.",
      "why_prose_payload": "Submitted payload is 10.0 kg, which exceeds the medium-risk threshold of 5 kg but remains below the MFC maximum payload (15.9 kg). Payload risk is medium.",
      "why_wind": [
        "wind_gust_kt=17.0",
        "mfc_max_wind_kt=19.4",
        "risk_level=MEDIUM",
        "elevated_wind_gusts"
      ],
      "why_payload": [
        "payload_kg=10.0",
        "mfc_payload_max_kg=15.9",
        "risk_level=MEDIUM",
        "elevated_payload_weight"
      ]
    },
    "reputation_agent": {
      "incident_analysis": {
        "incidents": [
          {
            "incident_code": "0101-100",
            "incident_category": "Airspace Violations",
            "incident_subcategory": "Night Operations Without Proper Lighting",
            "severity": "MEDIUM",
            "resolved": false,
            "session_id": "880e8400-e29b-41d4-a716-446655440003",
            "date": "2025-01-12T18:00:00Z"
          },
          {
            "incident_code": "0011-010",
            "incident_category": "Mid-Air Collisions / Near-Misses",
            "incident_subcategory": "Near Mid-Air Collision (NMAC)",
            "severity": "HIGH",
            "resolved": false,
            "session_id": "aa0e8400-e29b-41d4-a716-446655440005",
            "date": "2025-03-14T11:00:00Z"
          },
          {
            "incident_code": "0100-100",
            "incident_category": "Loss of Control / Malfunctions",
            "incident_subcategory": "Communication Loss (C2 Link)",
            "severity": "MEDIUM",
            "resolved": false,
            "session_id": "cc0e8400-e29b-41d4-a716-446655440007",
            "date": "2025-05-07T15:30:00Z"
          },
          {
            "incident_code": "0100-001",
            "incident_category": "Loss of Control / Malfunctions",
            "incident_subcategory": "GPS or Navigation Failure",
            "severity": "MEDIUM",
            "resolved": false,
            "session_id": "550e8400-e29b-41d4-a716-446655440015",
            "date": "2026-01-18T14:15:00Z"
          }
        ],
        "unresolved_incidents_present": true,
        "total_incidents": 4,
        "recent_incidents_count": 1
      },
      "risk_assessment": {
        "risk_level": "HIGH",
        "blocking_factors": [
          "unresolved_high_severity_incident"
        ],
        "confidence_factors": []
      },
      "drp_sessions_count": 21,
      "demo_steady_max_kt": 15.0,
      "demo_gust_max_kt": 15.0,
      "incident_codes": [
        "0101-100",
        "0011-010",
        "0011-010",
        "0100-100",
        "0101-100",
        "0100-001"
      ],
      "n_0100_0101": 4,
      "recommendation_prose": "Historical risk signal: HIGH. Sessions=21, demo wind envelope steady=15.0 kt gust=15.0 kt; n_0100_0101=4, unresolved_incidents_present=True.",
      "recommendation": "HIGH",
      "why_prose": "drp_sessions_count=21; demo_steady_max_kt=15.0; demo_gust_max_kt=15.0; n_0100_0101=4; unresolved_incidents_present=True; incident_prefixes_present=['0101', '0011', '0100']",
      "why": [
        "drp_sessions_count=21",
        "demo_steady_max_kt=15.0",
        "demo_gust_max_kt=15.0",
        "n_0100_0101=4",
        "unresolved_incidents_present=True",
        "incident_prefixes_present=['0101', '0011', '0100']"
      ]
    },
    "claims_agent": {
      "called": true,
      "satisfied": true,
      "resolved_incident_prefixes": [
        "0100",
        "0101",
        "0011"
      ],
      "unresolved_incident_prefixes": [],
      "satisfied_actions": [
        "RESOLVE_HIGH_SEVERITY_INCIDENTS"
      ],
      "unsatisfied_actions": [],
      "recommendation_prose": "All required actions have been satisfied. The operator provided verified follow-up for all high-severity incidents, including prefix 0011.",
      "why_prose": "Verified follow-up for high-severity incident prefixes was found in the records, specifically for prefix 0011, fulfilling the required actions.",
      "why": [
        "verified follow-up for high-severity prefix(es) ['0011'] (from sade-mock-data)"
      ]
    },
    "rule_trace": [
      "STATE_3_RULE_HIGH_SEV_INCIDENT",
      "STATE_5_RULE_CLAIMS_SATISFIED",
      "STATE_5_RULE_NEAR_ENVELOPE"
    ]
  }
}
